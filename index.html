<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
    <title>BI CBFEST 2025</title>
    <script src="./assets/js/lib.min.js"></script>
    <link rel="stylesheet" href="assets/css/style.css" />
    <style>
      ::-webkit-scrollbar {
        display: none;
      }
      /* Ensure all blend images use the right mode */
      .color-dodge {
        mix-blend-mode: color-dodge;
        will-change: opacity;
      }

      .pentagon-container {
        display: inline-block; /* or flex, depending on your layout needs */
        mix-blend-mode: color-dodge;
      }

      /* Remove mix-blend-mode from the .color-dodge class if the image will be animated */

      @font-face {
        font-family: "Orbitron";
        src: url("./assets/fonts/Orbitron-VariableFont_wght.ttf")
          format("truetype");
        font-display: swap;
      }
      * {
        font-family: "Orbitron", Arial, Helvetica, sans-serif;
      }
      body {
        color: white;
      }
      .title {
        font-weight: bold;
        position: relative;
        background: linear-gradient(
          90deg,
          #b48235 0%,
          #f8ee9a 20%,
          #f8ee9a 30%,
          #b48235 50%,
          #f8ee9a 70%,
          #f8ee9a 80%,
          #b48235 100%
        );
        -webkit-background-clip: text;
        background-clip: text;
        -webkit-text-fill-color: transparent;
        margin-bottom: 40px;
        /* text-shadow: 15px 15px 0 rgba(0, 0, 0, 0.5); */
      }
      .text-gradient {
        font-weight: bold;
        position: relative;
        background: linear-gradient(
          90deg,
          #b48235 0%,
          #f8ee9a 20%,
          #f8ee9a 30%,
          #b48235 50%,
          #f8ee9a 70%,
          #f8ee9a 80%,
          #b48235 100%
        );
        -webkit-background-clip: text;
        background-clip: text;
        -webkit-text-fill-color: transparent;
        margin-bottom: 40px;
        /* text-shadow: 15px 15px 0 rgba(0, 0, 0, 0.5); */
      }
      .title::before {
        content: attr(data-text);
        position: absolute;
        top: 0;
        left: 0;
        z-index: -1;
        color: #b48235;
        text-shadow: 5px 5px 5px rgba(0, 0, 0, 0.8);
      }
      .Arial {
        font-family: Arial, Helvetica, sans-serif;
      }
      /* .card-button {
        padding: 20px; 
        background: radial-gradient(
          circle,
          rgba(0, 0, 0, 0.95),
          rgba(0, 0, 0, 0.5)
        );
        border: 4px solid white;
        border-radius: 30px;
        text-align: center;
        font-weight: 500;
        cursor: pointer;
        transition: 0.3s;
        box-shadow: 0 8px 15px rgba(0, 0, 0, 0.3);
      }
      .card-button:hover {
        background: rgba(255, 255, 255, 0.1);
        transform: translateY(-3px);
        box-shadow: 0 12px 20px rgba(0, 0, 0, 0.4);
      } */
      .card-button {
        padding: 20px;
        border-radius: 30px;
        text-align: center;
        font-weight: 500;
        cursor: pointer;
        transition: 0.3s;
        box-shadow: 0 8px 15px rgba(0, 0, 0, 0.3);

        font-size: 48px;
        font-weight: bold;
        background: url("./assets/img/Button.svg");
        background-repeat: no-repeat;
        background-position: center;
        background-size: cover;
        /* -webkit-background-clip: text; */
        /* -webkit-text-fill-color: transparent; */
        /* background-clip: text; */
        /* text-fill-color: transparent; */
      }
      .text-button {
        background: linear-gradient(
          90deg,
          #b48235 0%,
          #f8ee9a 40%,
          #f8ee9a 60%,
          #b48235 100%
        );
        -webkit-background-clip: text;
        background-clip: text;
        -webkit-text-fill-color: transparent;
      }
      .card-button:hover {
        /* background: rgba(255, 2 55, 255, 0.1); */
        transform: translateY(-3px);
        box-shadow: 0 12px 20px rgba(0, 0, 0, 0.4);
      }

      /* Fade transition for background video */
      #bg_video,
      #bg_video_fade {
        transition: opacity 0.7s;
        will-change: opacity;
      }
      #bg_video_fade {
        position: absolute;
        inset: 0;
        z-index: -9;
        width: 100%;
        height: 100%;
        object-fit: cover;
        object-position: center;
        pointer-events: none;
        opacity: 0;
      }

      .text-shadow {
        text-shadow: 6px 8px 2px rgba(0, 0, 0, 0.5);
        /* 0px 1px 4px rgba(0,0,0,0.15); */
      }

    /* Gold-filled answer box (selected/correct letter) */
    .gold-filled-box {
      background: linear-gradient(135deg, #b48235 0%, #f8ee9a 100%);
      border-radius: 16px;
      box-shadow: 0 4px 16px rgba(180, 130, 53, 0.25);
      border: none;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 96px;
      height: 96px;
      margin: 8px;
      font-size: 2.5rem;
      font-weight: bold;
      color: #fff;
      letter-spacing: 2px;
      position: relative;
      transition: box-shadow 0.2s;
    }

    /* Gold-outline answer/choice box (unselected) */
    .gold-outline-box {
      background: transparent;
      border: 3px solid #f8ee9a;
      border-radius: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 96px;
      height: 96px;
      margin: 8px;
      font-size: 2.5rem;
      font-weight: bold;
      color: #b48235;
      letter-spacing: 2px;
      position: relative;
      transition: border-color 0.2s, box-shadow 0.2s;
    }

    /* Empty answer box (for blanks) */
    .empty-box {
      background: transparent;
      border: 3px solid #bcbcbc;
      border-radius: 16px;
      width: 96px;
      height: 96px;
      margin: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2.5rem;
      color: #bcbcbc;
      box-sizing: border-box;
      position: relative;
    }

    /* Letter text inside boxes */
    .letter-content {
      font-family: "Orbitron", Arial, Helvetica, sans-serif;
      font-size: 2.5rem;
      font-weight: bold;
      text-shadow: 0 2px 8px rgba(0,0,0,0.25);
      letter-spacing: 2px;
      user-select: none;
    }

    /* "CHOOSE THE LETTERS" title style */
    .choose-letters-title {
      font-family: "Orbitron", Arial, Helvetica, sans-serif;
      font-size: 2rem;
      font-weight: bold;
      background: linear-gradient(90deg, #b48235 0%, #f8ee9a 100%);
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
      text-fill-color: transparent;
      letter-spacing: 2px;
      text-align: center;
      margin: 24px 0 16px 0;
      text-transform: uppercase;
    }
    </style>
  </head>
  <body class="">
    <!-- save screen Video Layer  -->
    <video
      autoplay
      loop
      muted
      id="save_screen"
      style="
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        z-index: 9999;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.7s;
      "
    >
      <source
        src="./assets/videos/SAVE SCREEN.mp4"
        type="video/mp4"
        style="display: none"
      />
    </video>
    <!-- Background Video -->
    <video
      id="bg_video"
      autoplay
      loop
      muted
      class="absolute inset-0 -z-10 w-full h-full object-cover object-center"
      style="opacity: 1; isolation: isolate"
    >
      <source
        src="./assets/videos/MENU UTAMA.mp4"
        type="video/mp4"
        id="bg_menu_utama"
      />
      <source
        src="./assets/videos/SUB MENU.mp4"
        type="video/mp4"
        id="bg_sub_menu"
        style="display: none"
      />
    </video>
    <!-- Fade overlay video for transition -->
    <video
      id="bg_video_fade"
      autoplay
      loop
      muted
      style="opacity: 0; pointer-events: none"
      class="absolute inset-0 w-full h-full object-cover object-center"
    ></video>

    <!-- Main Content -->
    <!-- <h1 class="title" data-text="Title">Title asdibaffiq-ofn2-vn-2bv-</h1> -->
    <div id="content" class="relative overflow-hidden min-h-screen"></div>

    <!-- testing -->

    <!-- Scripts -->
    <script src="./assets/js/init.js"></script>
    <script src="./assets/js/data/home.js"></script>
    <script src="./assets/js/components/button.js"></script>
    <script src="./assets/js/components/card.js"></script>
    <script src="./assets/js/data/layanan-kebanksentralan.js"></script>
    <script src="./assets/js/data/layanan-kebanksentralan/CAS.js"></script>
    <script src="./assets/js/data/layanan-kebanksentralan/CAABP.js"></script>
    <script src="./assets/js/data/layanan-kebanksentralan/LCTS.js"></script>
    <script src="./assets/js/data/layanan-kebanksentralan/LCIBP.js"></script>
    <script src="./assets/js/data/layanan-kebanksentralan/SRS.js"></script>
    <script src="./assets/js/data/layanan-kebanksentralan/SRBS.js"></script>

    <script src="./assets/js/data/layanan-operasional-tresuri/profile.js"></script>
    <script src="./assets/js/data/layanan-operasional-tresuri/SRTS.js"></script>
    <script src="./assets/js/data/layanan-operasional-tresuri/SFTS.js"></script>
    <script src="./assets/js/data/layanan-operasional-tresuri/SNTS.js"></script>
    <script src="./assets/js/data/layanan-operasional-tresuri/SPS.js"></script>
    <script src="./assets/js/data/layanan-operasional-tresuri/GM.js"></script>
    <script src="./assets/js/data/layanan-operasional-tresuri/TNTSS.js"></script>
    <script src="./assets/js/data/layanan-operasional-tresuri/RAS.js"></script>
    <script src="./assets/js/data/layanan-operasional-tresuri/TMOI.js"></script>
    <script src="./assets/js/data/layanan-operasional-tresuri/MODRMO.js"></script>
    

    <!-- Perizinan Terpadu -->
    <script src="assets/js/data/perizinan-terpadu/integrated-licensing.js"></script>
    <script src="assets/js/data/perizinan-terpadu/LF.js"></script>
    <script src="assets/js/data/perizinan-terpadu/ETIBI.js"></script>
    <script src="assets/js/data/perizinan-terpadu/BSLAT1.js"></script>
    <script src="assets/js/data/perizinan-terpadu/BSLAT2.js"></script>
    <script src="assets/js/data/perizinan-terpadu/BSLAT3.js"></script>
    <script src="assets/js/data/perizinan-terpadu/IEFD.js"></script>
    <script src="assets/js/data/perizinan-terpadu/MASMD.js"></script>
    <script src="assets/js/data/perizinan-terpadu/MASMD2.js"></script>
    <script src="assets/js/data/perizinan-terpadu/FMDD1.js"></script>
    <script src="assets/js/data/perizinan-terpadu/FMDD2.js"></script>
    <script src="assets/js/data/perizinan-terpadu/FMDD3.js"></script>
    <script src="assets/js/data/perizinan-terpadu/FMDD4.js"></script>
    <script src="assets/js/data/perizinan-terpadu/FMDD5.js"></script>
    <script src="assets/js/data/perizinan-terpadu/MMAMSD.js"></script>
    <script src="assets/js/data/perizinan-terpadu/CMD1.js"></script>
    <script src="assets/js/data/perizinan-terpadu/CMD2.js"></script>
    <script src="assets/js/data/perizinan-terpadu/CMD3.js"></script>
    <script src="assets/js/data/perizinan-terpadu/PSPD.js"></script>
    <script src="assets/js/data/perizinan-terpadu/PSMD1.js"></script>
    <script src="assets/js/data/perizinan-terpadu/PSMD2.js"></script>
    <script src="assets/js/data/perizinan-terpadu/PSMD3.js"></script>
    <script src="assets/js/data/perizinan-terpadu/RMCD.js"></script>
    <!-- --- -->

    <script src="./assets/js/data/quiz/quiz.js"></script>
    
    <script src="./assets/js/jquery.js"></script>

    <script>
      // Data array for content lookup
      const data = [
        homeData,
        LK1Data,
        LK2Data,
        CAS,
        CAABP,
        LCTS,
        LCIBP,
        SRS,
        SRBS,
        treasuryProfile,
        SRTS,
        SFTS,
        SNTS,
        SPS,
        GM,
        TNTSS,
        RAS,
        TMOI,
        MODRMO,

        // perizinnan terpadu
        integratedLicensing,
        LF,
        ETIBI,
        BSLAT1,
        BSLAT2,
        BSLAT3,
        IEFD,
        MASMD,
        MASMD2,
        FMDD1,
        FMDD2,
        FMDD3,
        FMDD4,
        FMDD5,
        MMAMSD,
        CMD1,
        CMD2,
        CMD3,
        PSPD,
        PSMD1,
        PSMD2,
        PSMD3,
        RMCD,
        
        // quiz
        quiz,
      ];
      let homePage = null;
      // Store the last background video id to avoid unnecessary changes
      let lastBgVideoId = null;

      /**
       * Maps a tab id to the corresponding background video source id.
       * @param {string} tab
       * @returns {string}
       */
      function getBgVideoIdByTab(tab) {
        if (!tab || tab === "" || tab === "home") return "bg_menu_utama";
        // Add more mappings as needed
        return "bg_sub_menu";
      }

      /**
       * Updates the background video based on the current tab, with fade transition.
       * Only changes the video if the background video id is different from the last one.
       * @param {string} tab
       */
      function updateBgVideo(tab) {
        var $video = $("#bg_video");
        var $sources = $video.find("source");
        var bgId = getBgVideoIdByTab(tab);

        // Only update if the background video id has changed
        if (lastBgVideoId === bgId) {
          return;
        }

        var $activeSource = $("#" + bgId);
        if (!$activeSource.length) return;

        // Fade transition logic
        var $fadeVideo = $("#bg_video_fade");
        // Set the fade video src to the new video
        $fadeVideo[0].src = $activeSource.attr("src");
        $fadeVideo[0].currentTime = 0;
        $fadeVideo[0].load();

        // Start playing the fade video
        $fadeVideo[0].play().catch(function () {});

        // Fade in the overlay video
        $fadeVideo.css("opacity", 1);

        // After fade in, swap the main video and fade out the overlay
        setTimeout(function () {
          // Hide all sources
          $sources.css("display", "none");
          // Show the active source and update the video src
          $activeSource.css("display", "");
          $video[0].src = $activeSource.attr("src");
          $video[0].currentTime = 0;
          $video[0].load();
          $video[0].play().catch(function () {});

          // Fade out the overlay video
          $fadeVideo.css("opacity", 0);
        }, 700);

        lastBgVideoId = bgId;
      }

      /**
       * Loads the content for the current tab from the URL.
       */
      function loadContentFromUrl() {
        const search = new URLSearchParams(window.location.search);
        let tab = "";
        if (search.has("tab")) {
          tab = search.get("tab");
          const content = data.find((v) => v.id == tab);
          if (content) {
            $("#content").html(content.data);
          } else {
            $("#content").html(homeData.data);
          }
          if (tab == 'quiz') {
            initGame()
          }
        } else {
          $("#content").html(homeData.data);
        }
        updateBgVideo(tab);
      }

      // Initial page load
      $(function () {
        loadContentFromUrl();
      });

      /**
       * Handles navigation to the next tab/content.
       */
      // Helper function for fade transition
      function fadeContentTransition(newContent, nextTab, callback) {
        const $content = $("#content");
        $content.css({
          // transition: 'opacity 0.5s',
          opacity: 1,
        });

        // Fade out
        $content.css({ opacity: '0' });

          $content.html(newContent);
          // Fade in
          $content.css({ opacity: "1" });

          if (typeof callback === "function") callback();

          // Remove transition after animation to avoid interfering with other changes
        
      }

      $(document).on("click", "[data-next]", function () {
        const nextTab = $(this).attr("data-next");
        const dataContent = data.find((v) => v.id == nextTab);

        if (!dataContent) return;

        fadeContentTransition(dataContent.data, nextTab, function () {
          if (nextTab == 'quiz') {
            initGame();
          }
          updateBgVideo(nextTab);

          if (nextTab) {
            setSearchParam("tab", nextTab);
          }
        });
      });

      /**
       * Handles the back button click to return to the home page.
       */
      $(document).on("click", "[data-previous]", function () {
        const nextTab = $(this).attr("data-previous");
        const dataContent = data.find((v) => v.id == nextTab);

        if (!dataContent) return;

        fadeContentTransition(dataContent.data, nextTab, function () {
          if (nextTab == 'quiz') {
            initGame();
          }
          updateBgVideo(nextTab);

          if (nextTab) {
            setSearchParam("tab", nextTab);
          }
        });
      });

      function updateTitleDataText() {
        $(".title").each(function () {
          $(this).attr("data-text", $(this).html());
        });
      }

      // Run on initial load
      $(function () {
        updateTitleDataText();

        // Watch for changes inside #content
        const targetNode = document.getElementById("content");
        if (targetNode) {
          const observer = new MutationObserver(function (mutationsList) {
            for (const mutation of mutationsList) {
              if (
                mutation.type === "childList" ||
                mutation.type === "subtree"
              ) {
                updateTitleDataText();
              }
            }
          });

          observer.observe(targetNode, {
            childList: true, // watch for added/removed children
            subtree: true, // watch entire subtree
          });
        }
      });

      /**
       * Handles browser navigation (back/forward) using popstate.
       */
      window.addEventListener("popstate", function () {
        loadContentFromUrl();
      });

      // --- Save Screen Inactivity Logic ---
      // (function () {
      //   const saveScreen = document.getElementById("save_screen");
      //   const contentDiv = document.getElementById("content");
      //   let inactivityTimeout = null;
      //   let isSaveScreenActive = false;

      //   // Helper to show save screen with fade in
      //   function showSaveScreen() {
      //     if (isSaveScreenActive) return;
      //     isSaveScreenActive = true;
      //     saveScreen.style.pointerEvents = "auto";
      //     saveScreen.style.opacity = "1";
      //     if (contentDiv) contentDiv.style.filter = "blur(8px)";
      //   }

      //   // Helper to hide save screen with fade out
      //   function hideSaveScreen() {
      //     if (!isSaveScreenActive) return;
      //     isSaveScreenActive = false;
      //     saveScreen.style.opacity = "0";
      //     saveScreen.style.pointerEvents = "none";
      //     if (contentDiv) contentDiv.style.filter = "";
      //   }

      //   // Reset inactivity timer
      //   function resetInactivityTimer() {
      //     clearTimeout(inactivityTimeout);
      //     if (isSaveScreenActive) {
      //       hideSaveScreen();
      //     }
      //     inactivityTimeout = setTimeout(showSaveScreen, 60000);
      //   }

      //   // Listen for user interaction
      //   ["mousemove", "mousedown", "keydown", "touchstart", "scroll"].forEach(
      //     function (eventName) {
      //       window.addEventListener(eventName, resetInactivityTimer, true);
      //     }
      //   );

      //   // Start timer on load
      //   resetInactivityTimer();
      // })();
    </script>
  </body>
</html>
