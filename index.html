<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <script src="./assets/js/lib.min.js"></script>
    <link rel="stylesheet" href="assets/css/style.css" />
    <style>
      @font-face {
        font-family: "Orbitron";
        src: url("./assets/fonts/Orbitron-VariableFont_wght.ttf")
          format("truetype");
        font-display: swap;
      }
      html,
      body,
      * {
        font-family: "Orbitron", Arial, Helvetica, sans-serif !important;
      }
      @keyframes shine {
        0%,
        100% {
          box-shadow: 0 0 10px rgba(255, 255, 255, 0.5),
            0 0 20px rgba(0, 255, 255, 0.5), 0 0 30px rgba(0, 255, 255, 0.7);
        }
        50% {
          box-shadow: 0 0 20px rgba(255, 255, 255, 1),
            0 0 40px rgba(0, 255, 255, 1), 0 0 60px rgba(0, 255, 255, 1);
        }
      }
      body {
        /* margin: 0;
      background: linear-gradient(
        to bottom right,
        rgba(33, 0, 90, 0.9),
        rgba(255, 0, 0, 0.6)
      );
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      padding: 20px; */
        color: white;
      }
      h1 {
        font-size: 3rem;
        font-weight: bold;
        color: #ffd700;
        margin-bottom: 40px;
        text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.7);
      }
      .card-button {
        padding: 20px;
        background: radial-gradient(
          circle,
          rgba(0, 0, 0, 0.9),
          rgba(0, 0, 0, 0.5)
        );
        border: 4px solid white;
        border-radius: 30px;
        text-align: center;
        font-weight: 500;
        cursor: pointer;
        transition: 0.3s;
        box-shadow: 0 8px 15px rgba(0, 0, 0, 0.3);
      }
      .card-button:hover {
        background: rgba(255, 255, 255, 0.1);
        transform: translateY(-3px);
        box-shadow: 0 12px 20px rgba(0, 0, 0, 0.4);
      }

      /* Fade transition for background video */
    </style>
  </head>
  <body>
    <!-- Background Video -->
    <video
      id="bg_video"
      autoplay
      loop
      muted
      playsinline
      class="absolute inset-0 -z-10 w-full h-full object-cover object-center"
      style="opacity: 1"
    >
      <source
        src="./assets/videos/MENU UTAMA.mp4"
        type="video/mp4"
        id="bg_menu_utama"
      />
      <source
        src="./assets/videos/SAVE SCREEN.mp4"
        type="video/mp4"
        id="bg_save_screen"
        style="display: none"
      />
      <source
        src="./assets/videos/SUB MENU.mp4"
        type="video/mp4"
        id="bg_sub_menu"
        style="display: none"
      />
    </video>
    <!-- Main Content -->
    <div id="content" class="relative"></div>

    <!-- testing -->
    


    <!-- Scripts -->
    <script src="./assets/js/init.js"></script>
    <script src="./assets/js/data/home.js"></script>
    <script src="./assets/js/data/layanan-kebanksentralan.js"></script>
    <script src="./assets/js/jquery.js"></script>

    <script>
      let homePage = null;
      // Store the last background video id to avoid unnecessary changes
      let lastBgVideoId = null;

      /**
       * Maps a tab id to the corresponding background video source id.
       * @param {string} tab
       * @returns {string}
       */
      function getBgVideoIdByTab(tab) {
        if (!tab || tab === "" || tab === "home") return "bg_menu_utama";
        // Add more mappings as needed
        return "bg_sub_menu";
      }

      /**
       * Updates the background video based on the current tab, without fade transition.
       * Only changes the video if the background video id is different from the last one.
       * @param {string} tab
       */
      function updateBgVideo(tab) {
        var $video = $("#bg_video");
        var $sources = $video.find("source");

        var bgId = getBgVideoIdByTab(tab);

        // Only update if the background video id has changed
        if (lastBgVideoId === bgId) {
          return;
        }
        lastBgVideoId = bgId;

        // Hide all sources
        $sources.css("display", "none");

        // Show the active source and update the video src
        var $activeSource = $("#" + bgId);

        if ($activeSource.length) {
          $activeSource.css("display", "");
          $video[0].src = $activeSource.attr("src");
          $video[0].load();
          $video[0].play().catch(function () {});
        }
      }

      // Data array for content lookup
      const data = [homeData, LK1Data, LK2Data];

      /**
       * Loads the content for the current tab from the URL.
       */
      function loadContentFromUrl() {
        const search = new URLSearchParams(window.location.search);
        let tab = "";
        if (search.has("tab")) {
          tab = search.get("tab");
          const content = data.find((v) => v.id == tab);
          if (content) {
            $("#content").html(content.data);
          } else {
            $("#content").html(homeData.data);
          }
        } else {
          $("#content").html(homeData.data);
        }
        updateBgVideo(tab);
      }

      // Initial page load
      $(function () {
        loadContentFromUrl();
      });

      /**
       * Handles navigation to the next tab/content.
       */
      $(document).on("click", "[data-next]", function () {
        const nextTab = $(this).attr("data-next");
        const dataContent = data.find((v) => v.id == nextTab);

        $("#content").animate(
          { opacity: 0, left: "-100px" },
          500,
          async function () {
            $(this).html(dataContent.data);
            $(this).css({ left: "100px" });
            $(this).animate({ opacity: 1, left: "0" }, 500);
            updateBgVideo(nextTab);
          }
        );

        if (nextTab) {
          setSearchParam("tab", nextTab);
        }
      });

      /**
       * Handles the back button click to return to the home page.
       */
      $(document).on("click", "[data-previous]", function () {
        const nextTab = $(this).attr("data-previous");
        const dataContent = data.find((v) => v.id == nextTab);
        $("#content").animate(
          { opacity: 0, left: "100px" },
          500,
          async function () {
            $(this).html(dataContent.data);
            $(this).css({ left: "-100px" });
            $(this).animate({ opacity: 1, left: "0" }, 500);
            setSearchParam("tab", "");
            updateBgVideo("");
          }
        );
        if (nextTab) {
          setSearchParam("tab", nextTab);
        }
      });

      /**
       * Handles browser navigation (back/forward) using popstate.
       */
      window.addEventListener("popstate", function () {
        loadContentFromUrl();
      });
    </script>
  </body>
</html>
